/*! https://github.com/leeoniya/uDSV (v0.5.3) */
var uDSV=function(e){"use strict";const l=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/,t=/^(?:t(?:rue)?|f(?:alse)?|y(?:es)?|n(?:o)?|0|1)$/i,n=["\t","|",";",","],r="d",i="n",s="j",o="b";const c=JSON.stringify,u=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),f=e=>"string"==typeof e?c(e):e;function a(e,l){let{type:t}=l,n=`r[${e}]`,u=t===r?`new Date(${n})`:t===s?`JSON.parse(${n})`:t===i?"+"+n:t[0]===o?`${n} === ${c(t.slice(2))} ? true : false`:n,{repl:a}=l,h=void 0!==a.NaN&&t===i?`${n} === 'NaN' ? ${f(a.NaN)} : `:"",$=void 0!==a.null?`${n} === 'null' || ${n} === 'NULL' ? ${f(a.null)} : `:"";return`${void 0!==a.empty?`${n} === '' ? ${f(a.empty)} : `:""} ${$} ${h} ${u}`}const h=/\w+(?:\[|\]?[\.\[]?|$)/gm;function $(e,l=!1,t=!1){let n="";if(l&&t){let l={},t=0,r=e.map((e=>e.name.replace(/\.(\d+)\.?/gi,"[$1]")));do{let e=r.shift(),n=/\s/.test(e)?[e]:[...e.matchAll(h)].flatMap((e=>e.map((e=>e.replace("]",""))))),i=l;do{let e=n.shift(),l=e,r=e.at(-1);"."==r||"["==r?(l=e.slice(0,-1),i=i[l]=i[l]??("."==r?{}:[])):i[l]=`¦${t}¦`}while(n.length>0);t++}while(r.length>0);n=c(l).replace(/"¦(\d+)¦"/g,((l,t)=>a(+t,e[+t])))}else!l&&e.every((e=>"s"===e.type))?n="r":(n=l?"{":"[",e.forEach(((e,t)=>{n+=l?c(e.name)+":":"";let r=a(t,e);n+=r+","})),n+=l?"}":"]");return Function("rows",` let arr = Array(rows.length); for (let i = 0; i < rows.length; i++) { let r = rows[i]; arr[i] = ${n}; } return arr; `)}function p(e,l=!1){let{col:t,row:n,encl:i,esc:f,cols:a}=e,h=c(i),$=c(f+i),p=e=>`${h} + ${e}.replaceAll(${h}, ${$}) + ${h}`,d=a.map((({name:e,type:t,encl:n},i)=>{let u=`r[${l?c(e):i}]`,f=u;if(t[0]==o){let e=t.slice(2);f=e==`${u} ? '${e}' : '${function(e){let[l,t=""]=e;return"1"==l?"0":"t"==l?""==t?"f":"false":"T"==l?""==t?"F":"R"==t?"FALSE":"False":"y"==l?""==t?"n":"no":"Y"==l?""==t?"N":"E"==t?"NO":"No":""}(e)}'`}else"s"==t?f=n?p(u):0==n?u:`(!strChk.test(${u}) ? ${u} : ${p(u)})`:t==r?f=u+".toISOString()":t==s&&(f=p(`JSON.stringify(${u})`));return`(${u} == null ? '' : ${f})`})).join(" + "+c(t)+" + ")+" + "+c(n),g=`${u(t)}|${u(n)}|${u(i)}`,m=RegExp(g),y=a.map((e=>m.test(e.name)?i+e.name.replaceAll(i,f+i)+i:e.name)).join(t)+n;return Function(` let strChk = new RegExp(${c(g)}); return rows => { let out = ${c(y)}; for (let i = 0; i < rows.length; i++) { let r = rows[i]; out += ${d}; } return out; } `)()}function d(e,l,t,n=0,r=!0,i=1e3,s=null,o=null){let{row:c,col:u,encl:f,esc:a,trim:h}=l;f??=e.indexOf('"')>-1?'"':"",a??=f;let $=`${a}${f}`,p=o||l.cols.length,d=null!=s,g=null!=o&&d,m=c.length,y=u.length,A=f.charCodeAt(0),w=a.charCodeAt(0),N=c.charCodeAt(0),k=u.charCodeAt(0),C=0,O=0,b=e.length-1,x=0,E=[],S=Array(p).fill(""),v=S.slice(),j=0,F=p-1,R=-1;if(""===f){for(;b>=O;)if(j===F){let l=e.indexOf(c,O);if(-1===l){if(!r)break;l=b+1}let o=e.slice(O,l);if(v[j]=h?o.trim():o,0>--n&&E.push(v),E.length===i){let e=!1===t(E,"");if(E=[],e||d&&++C===s)return}v=S.slice(),j=0,R=-1,O=l+m,x=O}else if(0===j&&e.charCodeAt(O)===N)O+=m;else{let l=e.indexOf(u,O);if(-1===l&&!r)break;let t=e.slice(O,l);v[j]=h?t.trim():t,O=l+y,R=j++}return r&&j===F&&0>--n&&E.push(v),void(r&&0>=E.length||t(E,r?"":e.slice(x)))}const L=g?RegExp(`[^${u}${c}]+`,"my"):null;let T,Y=0,D="",J=O;for(;b>=O;){if(T=e.charCodeAt(O),0===Y)if(T===A){if(Y=2,O+=1,J=O,O>b)break;T=e.charCodeAt(O)}else if(T===k||T===N){if(T===N&&0===j){O+=m;continue}if(v[j]=D,R=j,j+=1,O+=1,D="",T===N){if(g&&F>R&&0===E.length&&(v.length=S.length=R+1,F=R),0>--n&&E.push(v),E.length===i){let e=!1===t(E,"");if(E=[],e||d&&++C===s)return}v=S.slice(),j=0,R=-1,O+=m-1,x=O}if(O>b)break;T=e.charCodeAt(O)}else if(h&&32===T)for(;32===T;)T=e.charCodeAt(++O);else Y=1;if(2===Y){let l=!1,t=0;for(;;)if(T===A)if(A===w){if(O+1>b){t=O,O=b+1;break}if(e.charCodeAt(O+1)!==A){Y=0,t=O,O+=1;break}if(O+=2,l=!0,O>b)break;T=e.charCodeAt(O)}else{if(e.charCodeAt(O-1)!==w){Y=0,t=O,O+=1;break}if(O+=1,l=!0,O>b)break;T=e.charCodeAt(O)}else{let l=e.indexOf(f,O);if(-1===l){O=b+1;break}O=l,T=A}(0===Y||O>b)&&(D=l?e.slice(J,t).replaceAll($,f):e.slice(J,t))}else if(1===Y)if(T===k||T===N){if(T===N&&0===j){O+=m;continue}if(v[j]=D,R=j,j+=1,O+=1,D="",T===N){if(g&&F>R&&0===E.length&&(v.length=S.length=R+1,F=R),0>--n&&E.push(v),E.length===i){let e=!1===t(E,"");if(E=[],e||d&&++C===s)return}v=S.slice(),j=0,R=-1,O+=m-1,x=O}Y=0}else if(g){L.lastIndex=O;let l=L.exec(e)[0];D+=l,O+=l.length}else{let l=e.indexOf(j===F?c:u,O);-1===l&&(l=b+1);let t=e.slice(O,l);D+=h?t.trim():t,O=l}}r&&j===F&&(v[j]=D,0>--n&&E.push(v),Y=0),t(E,r||0===Y&&!(-1===R?""!==D:F>R)?"":e.slice(x))}return e.inferSchema=function(e,c,u){let{header:f,col:a,row:h,encl:$,esc:p,trim:g=!1}=c??{};f??=e=>[e[0]],u??=10;const m=RegExp(`(.*)(${h??"\r\n|\r|\n"})`),y=e.match(m),A=y[1];h??=y[2],a??=n.find((e=>A.indexOf(e)>-1))??"";const w={skip:1,col:a,row:h,encl:$,esc:p,trim:g,cols:[]},N=A.split(a).length,k=[];d(e,w,(e=>{k.push(...e)}),0,!0,u,1,N);let C=f(k)??[],O=w.skip=C.length,b=C.find((e=>null!=e))??[...Array(k[0].length).keys()];return k.splice(0,O),b.forEach(((e,n)=>{let c=function(e,n){let c=n.findLast((l=>""!==l[e]&&"null"!==l[e]&&"NULL"!==l[e]&&"NaN"!==l[e])),u="s";if(null!=c){let n=c[e];u=l.test(n)?r:+n==+n?i:t.test(n)?o+":"+function(e){let[l,t=""]=e;return"1"==l||"0"==l?"1":"t"==l||"f"==l?""==t?"t":"true":"T"==l||"F"==l?""==t?"T":"R"==t||"A"===t?"TRUE":"True":"y"==l||"n"==l?""==t?"y":"yes":"Y"==l||"N"==l?""==t?"Y":"E"==t||"O"===t?"YES":"Yes":""}(n):function(e){if("["===e[0]||"{"===e[0])try{return JSON.parse(e),!0}catch{}return!1}(n)?s:u}return u}(n,k);w.cols.push({name:e,type:c,repl:{empty:null,NaN:void 0,null:void 0}})})),w},e.initParser=function(e,l){let{skip:t,cols:n}=e,r=null,i=null,s=null,o=null,c=null,u=0,f=0,a=null,h=null,p="",g="",m=null;function y(){f=u=0,g=p="",a=h=m=null}let A=(e,l)=>{l(e)},w=()=>[],N=e=>{m.push(...e)};function k(n,r,i){let s=null;return(o,c=A)=>{s??=i(),m??=n();let a=m,h=0===f||2===f;return d(o,e,((e,l)=>{g=l;let t=c(s(e),r);return!1===t&&0!==f&&y(),t}),0===u?t:0,h,l),h&&(m=null),a}}const C=k(w,N,(()=>(r??=e=>e,r))),O=k(w,N,(()=>(i??=$(n,!1,!1),i))),b=k(w,N,(()=>(s??=$(n,!0,!1),s))),x=k(w,N,(()=>(o??=$(n,!0,!0),o))),E=k((()=>n.map((()=>[]))),(e=>{e.forEach(((e,l)=>{m[l].push(...e)}))}),(()=>(i??=$(n,!1,!1),c??=function(e){return Function("rows",` let cols = [${e.map((()=>"Array(rows.length)")).join(",")}]; for (let i = 0; i < rows.length; i++) { let r = rows[i]; ${e.map(((e,l)=>`cols[${l}][i] = r[${l}]`)).join(";")}; } return cols; `)}(n),e=>c(i(e)))));return{schema:e,stringArrs:C,typedArrs:O,typedObjs:b,typedDeep:x,typedCols:E,chunk(e,l=C,t=A){a??=l,h??=t,1===f&&(a(g+p,h),u++),p=e,f=1},end(){f=2;let e=a(g+p,h);return y(),e}}},e.initUnparser=function(e){let l=null,t=null;return{schema:e,fromArrs:t=>(l??=p(e),l(t)),fromObjs:l=>(t??=p(e,!0),t(l)),fromDeep(e){},fromCols(e){}}},e}({});
