/*! https://github.com/leeoniya/uDSV (v0.7.2) */
var uDSV=function(e){"use strict";const t=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2}))?$/,l=/^(?:t(?:rue)?|f(?:alse)?|y(?:es)?|n(?:o)?|0|1)$/i,n=["\t","|",";",","];function r(e){return 65279===e.charCodeAt(0)?e.slice(1):e}const i="d",s="t",c="n",f="j",u="b";const o=JSON.stringify,a=e=>"string"==typeof e?o(e):e;function d(e,t){let{type:l,parse:n}=t,r=`r[${e}]`,d=null!=n?`c[${e}].parse(${r})`:l===i?`new Date(${r})`:l===s?`Date.parse(${r})`:l===f?`JSON.parse(${r})`:l===c?"+"+r:l[0]===u?`${r} === ${o(l.slice(2))} ? true : false`:r,{repl:h}=t,p=void 0!==h.NaN&&l===c?`${r} === 'NaN' ? ${a(h.NaN)} : `:"",$=void 0!==h.null?`${r} === 'null' || ${r} === 'NULL' ? ${a(h.null)} : `:"";return`${void 0!==h.empty?`${r} === '' ? ${a(h.empty)} : `:""} ${$} ${p} ${d}`}const h=/\w+(?:\[|\]?[\.\[]?|$)/gm;function p(e,t=!1,l=!1){let n="";if(t&&l){let t={},l=0,r=e.map((e=>e.name.replace(/\.(\d+)\.?/gi,"[$1]")));do{let e=r.shift(),n=/\s/.test(e)?[e]:[...e.matchAll(h)].flatMap((e=>e.map((e=>e.replace("]",""))))),i=t;do{let e=n.shift(),t=e,r=e.at(-1);"."==r||"["==r?(t=e.slice(0,-1),i=i[t]=i[t]??("."==r?{}:[])):i[t]=`¦${l}¦`}while(n.length>0);l++}while(r.length>0);n=o(t).replace(/"¦(\d+)¦"/g,((t,l)=>d(+l,e[+l])))}else!t&&e.every((e=>"s"===e.type))?n="r":(n=t?"{":"[",e.forEach(((e,l)=>{n+=t?o(e.name)+":":"";let r=d(l,e);n+=r+","})),n+=t?"}":"]");return Function("c",`return r => (${n});`)(e)}function $(e,t,l=0,n=(()=>!0),i=!0,s){e=r(e);let{row:c,col:f,encl:u,esc:o,trim:a}=t;u??=e.indexOf('"')>-1?'"':"",o??=u;let d=`${o}${u}`,h=s??t.cols.length,p=null!=s,$=c.length,g=f.length,y=u.charCodeAt(0),m=o.charCodeAt(0),A=c.charCodeAt(0),b=f.charCodeAt(0),k=["",!1],N=0,C=e.length-1,O=0,x=Array(h).fill(""),w=x.slice(),v=0,E=h-1,S=-1;if(""===u){for(;C>=N;)if(v===E){let t=e.indexOf(c,N);if(-1===t){if(!i)break;t=C+1}let r=e.slice(N,t);if(w[v]=a?r.trim():r,0>--l&&!1===n(w))return k[1]=!0,k;w=x.slice(),v=0,S=-1,N=t+$,O=N}else if(0===v&&e.charCodeAt(N)===A)N+=$;else{let t=e.indexOf(f,N);if(-1===t&&!i)break;let l=e.slice(N,t);w[v]=a?l.trim():l,N=t+g,S=v++}return 0>--l&&i&&v===E&&S>-1&&n(w),k[0]=i?"":e.slice(O),k}const L=p?RegExp(`[^${f}${c}]+`,"my"):null;let T=0,j="",D=0,R=N;for(;C>=N;){if(D=e.charCodeAt(N),0===T)if(D===y){if(T=2,N+=1,R=N,N>C)break;D=e.charCodeAt(N)}else if(D===b||D===A){if(D===A&&0===v){N+=$;continue}if(w[v]=j,S=v,v+=1,N+=1,j="",D===A){if(p&&E>S&&0===O&&(w.length=x.length=S+1,E=S),0>--l&&!1===n(w))return k[1]=!0,k;w=x.slice(),v=0,S=-1,N+=$-1,O=N}if(N>C)break}else if(a&&32===D)for(;32===D;)D=e.charCodeAt(++N);else T=1;if(2===T){let t=!1,l=0;for(;;)if(D===y)if(y===m){if(N+1>C){l=N,N=C+1;break}if(e.charCodeAt(N+1)!==y){T=0,l=N,N+=1;break}if(N+=2,t=!0,N>C)break;D=e.charCodeAt(N)}else{if(e.charCodeAt(N-1)!==m){T=0,l=N,N+=1;break}if(N+=1,t=!0,N>C)break;D=e.charCodeAt(N)}else{let t=e.indexOf(u,N);if(-1===t){N=C+1;break}N=t,D=y}(0===T||N>C)&&(j=t?e.slice(R,l).replaceAll(d,u):e.slice(R,l))}else if(1===T)if(D===b||D===A){if(D===A&&0===v){N+=$;continue}if(w[v]=j,S=v,v+=1,N+=1,j="",D===A){if(p&&E>S&&0===O&&(w.length=x.length=S+1,E=S),0>--l&&!1===n(w))return k[1]=!0,k;w=x.slice(),v=0,S=-1,N+=$-1,O=N}T=0}else if(p){L.lastIndex=N;let t=L.exec(e)[0];j=t,N+=t.length}else{let t=e.indexOf(v===E?c:f,N);-1===t&&(t=C+1);let l=e.slice(N,t);j=a?l.trim():l,N=t}}return i&&v===E&&(w[v]=j,0>--l&&n(w),T=0),k[0]=i||0===T&&!(-1===S?""!==j:E>S)?"":e.slice(O),k}return e.inferSchema=function(e,s,o){let{header:a,col:d,row:h,encl:p,esc:g,trim:y=!1}=s??{};a??=e=>[e[0]],o??=10,e=r(e);const m=RegExp(`(.*)(${h??"\r\n|\r|\n"})`),A=e.match(m),b=A[1];h??=A[2],d??=n.find((e=>b.indexOf(e)>-1))??",";const k={skip:1,col:d,row:h,encl:p,esc:g,trim:y,cols:[]},N=b.split(d).length,C=[];$(e,k,0,(e=>(C.push(e),o>C.length)),!0,N);let O=a(C)??[],x=k.skip=O.length,w=O.find((e=>null!=e))??[...Array(C[0].length).keys()];return C.splice(0,x),w.forEach(((e,n)=>{let r=function(e,n){let r=n.findLast((t=>""!==t[e]&&"null"!==t[e]&&"NULL"!==t[e]&&"NaN"!==t[e])),s="s";if(null!=r){let n=r[e];s=t.test(n)?i:+n==+n?c:l.test(n)?u+":"+function(e){let[t,l=""]=e;return"1"==t||"0"==t?"1":"t"==t||"f"==t?""==l?"t":"true":"T"==t||"F"==t?""==l?"T":"R"==l||"A"===l?"TRUE":"True":"y"==t||"n"==t?""==l?"y":"yes":"Y"==t||"N"==t?""==l?"Y":"E"==l||"O"===l?"YES":"Yes":""}(n):function(e){if("["===e[0]||"{"===e[0])try{return JSON.parse(e),!0}catch{}return!1}(n)?f:s}return s}(n,C);k.cols.push({name:e,type:r,repl:{empty:null,NaN:void 0,null:void 0}})})),k},e.initParser=function(e){let{skip:t,cols:l}=e,n=null,r=null,i=null,s=null,c=null,f=0,u=null,o=null,a="",d=null;function h(){f=0,a="",u=o=d=null}let g=(e,t,l)=>(l(t,e),!0),y=()=>[],m=()=>l.map((()=>[])),A=(e,t)=>{e.push(t)},b=Function("buf","row",` ${e.cols.map(((e,t)=>"buf["+t+"].push(row["+t+"])")).join(";")}; `);function k(l,n,r){let i=null;return(s,c=g)=>{i??=r();let u=null==d?t:0;d??=l();let o=d,p=0===f||2===f,y=!1;if(Array.isArray(s)){for(let e=0;s.length>e;e++)if(!1===c(i(s[e]),o,n)){y=!0;break}}else[a,y]=$(s,e,u,(e=>c(i(e),o,n)),p);return y&&0!==f&&h(),p&&(d=null),o}}const N=()=>(n??=e=>e,n),C=()=>(r??=p(l,!1,!1),r),O=k(y,A,N),x=k(y,A,(()=>(c??=p(l.map((e=>({...e,type:"s",repl:{...e.repl,empty:void 0}}))),!0,!1),c))),w=k(y,A,C),v=k(y,A,(()=>(i??=p(l,!0,!1),i))),E=k(y,A,(()=>(s??=p(l,!0,!0),s))),S=k(m,b,C),L=k(m,b,N);return{schema:e,stringArrs:O,stringObjs:x,stringCols:L,typedArrs:w,typedObjs:v,typedDeep:E,typedCols:S,chunk(e,t=O,l=g){u??=t,o??=l,f=1,u(a+e,o)},end(){f=2;let e=u(a,o);return h(),e}}},e}({});
