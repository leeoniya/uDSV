/*! https://github.com/leeoniya/uDSV (v0.7.2) */
var uDSV=function(e){"use strict";const l=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2}))?$/,t=/^(?:t(?:rue)?|f(?:alse)?|y(?:es)?|n(?:o)?|0|1)$/i,n=["\t","|",";",","];function r(e){return 65279===e.charCodeAt(0)?e.slice(1):e}const i="d",s="t",c="n",f="j",u="b";const a=JSON.stringify,o=e=>"string"==typeof e?a(e):e;function d(e,l){let{type:t,parse:n,repl:r}=l,d=`r[${e}]`,h=null!=n?`c[${e}].parse(${d})`:t===i?`new Date(${d})`:t===s?`Date.parse(${d})`:t===f?`JSON.parse(${d})`:t===c?"+"+d:t[0]===u?`${d} === ${a(t.slice(2))} ? true : false`:d,p=void 0!==r.NaN&&t===c?`${d} === 'NaN' ? ${o(r.NaN)} : `:"",$=void 0!==r.null?`${d} === 'null' || ${d} === 'NULL' ? ${o(r.null)} : `:"";return`${void 0!==r.empty?`${d} === '' ? ${o(r.empty)} : `:""} ${$} ${p} ${h}`}const h=/\w+(?:\[|\]?[\.\[]?|$)/gm;function p(e,l=!1,t=!1){let n="";if(l&&t){let l={},t=0,r=e.map((e=>e.name.replace(/\.(\d+)\.?/gi,"[$1]")));do{let e=r.shift(),n=/\s/.test(e)?[e]:[...e.matchAll(h)].flatMap((e=>e.map((e=>e.replace("]",""))))),i=l;do{let e=n.shift(),l=e,r=e.at(-1);"."==r||"["==r?(l=e.slice(0,-1),i=i[l]=i[l]??("."==r?{}:[])):i[l]=`¦${t}¦`}while(n.length>0);t++}while(r.length>0);n=a(l).replace(/"¦(\d+)¦"/g,((l,t)=>d(+t,e[+t])))}else!l&&e.every((e=>"s"===e.type))?n="r":(n=l?"{":"[",e.forEach(((e,t)=>{n+=l?a(e.name)+":":"";let r=d(t,e);n+=r+","})),n+=l?"}":"]");return Function("c",`return r => (${n});`)(e)}function $(e,l,t=0,n=(()=>!0),i=!0,s){e=r(e);let{row:c,col:f,encl:u,esc:a,trim:o}=l;u??=e.indexOf('"')>-1?'"':"",a??=u;let d=`${a}${u}`,h=s??l.cols.length,p=null!=s,$=c.length,g=f.length,y=u.charCodeAt(0),m=a.charCodeAt(0),A=c.charCodeAt(0),N=f.charCodeAt(0),k=["",!1],C=0,b=e.length-1,O=0,x=Array(h).fill(""),E=x.slice(),v=0,w=h-1,D=-1;if(""===u){for(;b>=C;)if(v===w){let l=e.indexOf(c,C);if(-1===l){if(!i)break;l=b+1}let r=e.slice(C,l);if(E[v]=o?r.trim():r,0>--t&&!1===n(E))return k[1]=!0,k;E=x.slice(),v=0,D=-1,C=l+$,O=C}else if(0===v&&e.charCodeAt(C)===A)C+=$;else{let l=e.indexOf(f,C);if(-1===l&&!i)break;let t=e.slice(C,l);E[v]=o?t.trim():t,C=l+g,D=v++}return 0>--t&&i&&v===w&&D>-1&&n(E),k[0]=i?"":e.slice(O),k}const S=p?RegExp(`[^${f}${c}]+`,"my"):null;let L=0,T="",U=0,R=C;for(;b>=C;){if(U=e.charCodeAt(C),0===L)if(U===y){if(L=2,C+=1,R=C,C>b)break;U=e.charCodeAt(C)}else if(U===N||U===A){if(U===A&&0===v){C+=$;continue}if(E[v]=T,D=v,v+=1,C+=1,T="",U===A){if(p&&w>D&&0===O&&(E.length=x.length=D+1,w=D),0>--t&&!1===n(E))return k[1]=!0,k;E=x.slice(),v=0,D=-1,C+=$-1,O=C}if(C>b)break}else if(o&&32===U)for(;32===U;)U=e.charCodeAt(++C);else L=1;if(2===L){let l=!1,t=0;for(;;)if(U===y)if(y===m){if(C+1>b){t=C,C=b+1;break}if(e.charCodeAt(C+1)!==y){L=0,t=C,C+=1;break}if(C+=2,l=!0,C>b)break;U=e.charCodeAt(C)}else{if(e.charCodeAt(C-1)!==m){L=0,t=C,C+=1;break}if(C+=1,l=!0,C>b)break;U=e.charCodeAt(C)}else{let l=e.indexOf(u,C);if(-1===l){C=b+1;break}C=l,U=y}(0===L||C>b)&&(T=l?e.slice(R,t).replaceAll(d,u):e.slice(R,t))}else if(1===L)if(U===N||U===A){if(U===A&&0===v){C+=$;continue}if(E[v]=T,D=v,v+=1,C+=1,T="",U===A){if(p&&w>D&&0===O&&(E.length=x.length=D+1,w=D),0>--t&&!1===n(E))return k[1]=!0,k;E=x.slice(),v=0,D=-1,C+=$-1,O=C}L=0}else if(p){S.lastIndex=C;let l=S.exec(e)[0];T=l,C+=l.length}else{let l=e.indexOf(v===w?c:f,C);-1===l&&(l=b+1);let t=e.slice(C,l);T=o?t.trim():t,C=l}}return i&&v===w&&(E[v]=T,0>--t&&n(E),L=0),k[0]=i||0===L&&!(-1===D?""!==T:w>D)?"":e.slice(O),k}return e.inferSchema=function(e,s,a){let{header:o,col:d,row:h,encl:p,esc:g,trim:y=!1}=s??{};o??=e=>[e[0]],a??=10,e=r(e);const m=RegExp(`(.*)(${h??"\r\n|\r|\n"})`),A=e.match(m),N=A[1];h??=A[2],d??=n.find((e=>N.indexOf(e)>-1))??",";const k={skip:1,col:d,row:h,encl:p,esc:g,trim:y,cols:[]},C=N.split(d).length,b=[];$(e,k,0,(e=>(b.push(e),a>b.length)),!0,C);let O=o(b)??[],x=k.skip=O.length,E=O.find((e=>null!=e))??[...Array(b[0].length).keys()];return b.splice(0,x),E.forEach(((e,n)=>{let r=function(e,n){let r=n.findLast((l=>""!==l[e]&&"null"!==l[e]&&"Null"!==l[e]&&"NULL"!==l[e]&&"NaN"!==l[e]&&"undefined"!==l[e]&&"Undefined"!==l[e]&&"UNDEFINED"!==l[e])),s="s";if(null!=r){let n=r[e];s=l.test(n)?i:+n==+n?c:t.test(n)?u+":"+function(e){let[l,t=""]=e;return"1"==l||"0"==l?"1":"t"==l||"f"==l?""==t?"t":"true":"T"==l||"F"==l?""==t?"T":"R"==t||"A"===t?"TRUE":"True":"y"==l||"n"==l?""==t?"y":"yes":"Y"==l||"N"==l?""==t?"Y":"E"==t||"O"===t?"YES":"Yes":""}(n):function(e){if("["===e[0]||"{"===e[0])try{return JSON.parse(e),!0}catch{}return!1}(n)?f:s}return s}(n,b);k.cols.push({name:e,type:r,repl:{empty:null,NaN:void 0,null:void 0,undefined:""}})})),k},e.initParser=function(e){let{skip:l,cols:t}=e,n=null,r=null,i=null,s=null,c=null,f=0,u=null,a=null,o="",d=null;function h(){f=0,o="",u=a=d=null}let g=(e,l,t)=>(t(l,e),!0),y=()=>[],m=()=>t.map((()=>[])),A=(e,l)=>{e.push(l)},N=(e,l)=>{for(let n=0;t.length>n;n++)e[n].push(l[n])};function k(t,n,r){let i=null;return(s,c=g)=>{i??=r();let u=null==d?l:0;d??=t();let a=d,p=0===f||2===f,y=!1;if(Array.isArray(s)){for(let e=0;s.length>e;e++)if(!1===c(i(s[e]),a,n)){y=!0;break}}else[o,y]=$(s,e,u,(e=>c(i(e),a,n)),p);return y&&0!==f&&h(),p&&(d=null),a}}const C=()=>(n??=e=>e,n),b=()=>(r??=p(t,!1,!1),r),O=k(y,A,C),x=k(y,A,(()=>(c??=p(t.map((e=>({...e,type:"s",repl:{...e.repl,empty:void 0}}))),!0,!1),c))),E=k(y,A,b),v=k(y,A,(()=>(i??=p(t,!0,!1),i))),w=k(y,A,(()=>(s??=p(t,!0,!0),s))),D=k(m,N,b),S=k(m,N,C);return{schema:e,stringArrs:O,stringObjs:x,stringCols:S,typedArrs:E,typedObjs:v,typedDeep:w,typedCols:D,chunk(e,l=O,t=g){u??=l,a??=t,f=1,u(o+e,a)},end(){f=2;let e=u(o,a);return h(),e}}},e}({});
